<Routes />

<script suppress-error="BL9992">
    let executionToolbarComponent = null;
    let hotkeyListeners = [];
    const logPrefix = '[Blazor App JS]';
    const log = (...args) => console.debug(logPrefix, ...args);

    window.setupExecutionHotkeys = (dotNetObjectRef) => {
        log('setupExecutionHotkeys invoked');
        executionToolbarComponent = dotNetObjectRef;
        
        // Remove existing listeners
        cleanupExecutionHotkeys();
        
        // Add new listeners
        const handleKeydown = (event) => {
            // Only handle if not in an input field
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }
            
            switch (event.code) {
                case 'F9':
                    event.preventDefault();
                    executionToolbarComponent.invokeMethodAsync('HandleHotkey', 'F9');
                    break;
                case 'F10':
                    event.preventDefault();
                    executionToolbarComponent.invokeMethodAsync('HandleHotkey', 'F10');
                    break;
                case 'F11':
                    event.preventDefault();
                    executionToolbarComponent.invokeMethodAsync('HandleHotkey', 'F11');
                    break;
            }
        };
        
        document.addEventListener('keydown', handleKeydown);
        hotkeyListeners.push(handleKeydown);
    };

    window.cleanupExecutionHotkeys = () => {
        log('cleanupExecutionHotkeys invoked');
        hotkeyListeners.forEach(listener => {
            document.removeEventListener('keydown', listener);
        });
        hotkeyListeners = [];
        executionToolbarComponent = null;
    };

    // Prevent default F11 behavior (fullscreen) when toolbar is active
    document.addEventListener('keydown', (event) => {
        if (event.code === 'F11' && executionToolbarComponent) {
            log('Intercepted F11');
            event.preventDefault();
        }
    });
</script>
